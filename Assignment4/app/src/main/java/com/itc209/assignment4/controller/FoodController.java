package com.itc209.assignment4.controller;

import android.content.Context;

import com.itc209.assignment4.dao.FoodDao;
import com.itc209.assignment4.model.Food;
import com.squareup.okhttp.OkHttpClient;
import com.squareup.okhttp.Request;

import org.json.JSONArray;
import org.json.JSONException;
import org.json.JSONObject;

import java.util.ArrayList;
import java.util.HashSet;
import java.util.List;
import java.util.Set;

public class FoodController {

    private final Context context;
    private FoodDao foodDao;

    public FoodController(Context context) {
        this.context = context;
        setFoodDao(new FoodDao(this.context));
    }

    public FoodDao getFoodDao() {
        return foodDao;
    }

    public void setFoodDao(FoodDao foodDao) {
        this.foodDao = foodDao;
    }

    public List<Food> findFoodsByKeyword(String keyword) {

        Set<Food> foods = new HashSet<>();

        // fetch any matching foods from the API
        try {
            OkHttpClient client = new OkHttpClient();

            Request request = new Request.Builder()
                    .url("https://chomp-food-nutrition-database-v2.p.rapidapi.com/food/branded/search.php?page=1&country=Australia&keyword=" + keyword)
                    .get()
                    .addHeader("X-RapidAPI-Key", "9f55517a4fmshac05f95235696eep1e1860jsn4d810b98d8b6")
                    .addHeader("X-RapidAPI-Host", "chomp-food-nutrition-database-v2.p.rapidapi.com")
                    .build();

            //Response response = client.newCall(request).execute();
            // JSONObject responseJson = new JSONObject(response.body().string());
            JSONObject responseJson = new JSONObject("{\"items\":[{\"barcode\":\"6136722888115\",\"name\":\"apples, sliced and dried\",\"brand\":\"angas park\",\"ingredients\":null,\"package\":{\"quantity\":200,\"size\":\"100g\"},\"serving\":{\"size\":null,\"measurement_unit\":null,\"size_fulltext\":null},\"categories\":[],\"nutrients\":[],\"diet_labels\":{\"vegan\":{\"name\":\"Vegan\",\"is_compatible\":null,\"compatibility_level\":null,\"confidence\":null,\"confidence_description\":\"We aren't able to check for compatibility with Vegan diet as ingredients are missing.\"},\"vegetarian\":{\"name\":\"Vegetarian\",\"is_compatible\":null,\"compatibility_level\":null,\"confidence\":null,\"confidence_description\":\"We aren't able to check for compatibility with Vegetarian diet as ingredients are missing.\"},\"gluten_free\":{\"name\":\"Gluten Free\",\"is_compatible\":null,\"compatibility_level\":null,\"confidence\":null,\"confidence_description\":\"We aren't able to check for compatibility with Gluten Free diet as ingredients are missing.\"}},\"diet_flags\":[],\"packaging_photos\":{\"front\":{\"small\":\"https:\\/\\/chompthis.com\\/api\\/assets\\/images\\/product\\/?i=613\\/672\\/288\\/8115\\/front_en.3.200.jpg\",\"thumb\":\"https:\\/\\/chompthis.com\\/api\\/assets\\/images\\/product\\/?i=613\\/672\\/288\\/8115\\/front_en.3.100.jpg\",\"display\":\"https:\\/\\/chompthis.com\\/api\\/assets\\/images\\/product\\/?i=613\\/672\\/288\\/8115\\/front_en.3.400.jpg\"},\"nutrition\":{\"small\":null,\"thumb\":null,\"display\":null},\"ingredients\":{\"small\":null,\"thumb\":null,\"display\":null}},\"allergens\":[],\"brand_list\":[\"Angas Park\"],\"countries\":[\"Australia\"],\"country_details\":{\"english_speaking\":1,\"non_english_speaking\":0},\"palm_oil_ingredients\":[],\"ingredient_list\":[],\"has_english_ingredients\":true,\"minerals\":[],\"vitamins\":[],\"traces\":[],\"description\":null,\"keywords\":[\"And\",\"Anga\",\"Apple\",\"Dried\",\"Park\",\"Sliced\"]},{\"barcode\":\"8710812896006\",\"name\":\"Botany Applesauce\",\"brand\":\"Botany\",\"ingredients\":\"Apples(90%), sugar, acidîty regulator(cîtric acid). antioxydant (L-asorbic acid) sugar content: 18% (of which 50% added)\",\"package\":{\"quantity\":700,\"size\":\"100g\"},\"serving\":{\"size\":null,\"measurement_unit\":null,\"size_fulltext\":null},\"categories\":[],\"nutrients\":[],\"diet_labels\":{\"vegan\":{\"name\":\"Vegan\",\"is_compatible\":null,\"compatibility_level\":1,\"confidence\":true,\"confidence_description\":\"Compatibility with the Vegan diet is unknown.\"},\"vegetarian\":{\"name\":\"Vegetarian\",\"is_compatible\":null,\"compatibility_level\":1,\"confidence\":true,\"confidence_description\":\"Compatibility with the Vegetarian diet is unknown.\"},\"gluten_free\":{\"name\":\"Gluten Free\",\"is_compatible\":true,\"compatibility_level\":2,\"confidence\":true,\"confidence_description\":\"Compatible with the Gluten Free diet.\"}},\"diet_flags\":[{\"ingredient\":\"Sugar\",\"ingredient_description\":\"A sweet material that consists of sucrose. Some sugars are processed through boneblack.\",\"diet_label\":\"Vegan\",\"is_compatible\":null,\"compatibility_level\":1,\"compatibility_description\":\"Not necessarily banned. Consider the source of each ingredient.\",\"is_allergen\":false},{\"ingredient\":\"Citric\",\"ingredient_description\":\"Emulsifier - May contain animal fat as it is derived from Glycerin\\/Glycerol.\",\"diet_label\":\"Vegan\",\"is_compatible\":null,\"compatibility_level\":1,\"compatibility_description\":\"Not necessarily banned. Consider the source of each ingredient.\",\"is_allergen\":false},{\"ingredient\":\"Citric\",\"ingredient_description\":\"Emulsifier - May contain animal fat as it is derived from Glycerin\\/Glycerol.\",\"diet_label\":\"Vegetarian\",\"is_compatible\":null,\"compatibility_level\":1,\"compatibility_description\":\"Not necessarily banned. Consider the source of each ingredient.\",\"is_allergen\":false}],\"packaging_photos\":{\"front\":{\"small\":\"https:\\/\\/chompthis.com\\/api\\/assets\\/images\\/product\\/?i=871\\/081\\/289\\/6006\\/front_en.7.200.jpg\",\"thumb\":\"https:\\/\\/chompthis.com\\/api\\/assets\\/images\\/product\\/?i=871\\/081\\/289\\/6006\\/front_en.7.100.jpg\",\"display\":\"https:\\/\\/chompthis.com\\/api\\/assets\\/images\\/product\\/?i=871\\/081\\/289\\/6006\\/front_en.7.400.jpg\"},\"nutrition\":{\"small\":null,\"thumb\":null,\"display\":null},\"ingredients\":{\"small\":\"https:\\/\\/chompthis.com\\/api\\/assets\\/images\\/product\\/?i=871\\/081\\/289\\/6006\\/ingredients_en.9.200.jpg\",\"thumb\":\"https:\\/\\/chompthis.com\\/api\\/assets\\/images\\/product\\/?i=871\\/081\\/289\\/6006\\/ingredients_en.9.100.jpg\",\"display\":\"https:\\/\\/chompthis.com\\/api\\/assets\\/images\\/product\\/?i=871\\/081\\/289\\/6006\\/ingredients_en.9.400.jpg\"}},\"allergens\":[],\"brand_list\":[\"Botany\"],\"countries\":[\"Australia\"],\"country_details\":{\"english_speaking\":1,\"non_english_speaking\":0},\"palm_oil_ingredients\":[],\"ingredient_list\":[\"18\",\"90\",\"Acidity Regulator\",\"Antioxydant\",\"Apples\",\"Citric Acid\",\"L Asorbic Acid Sugar Content\",\"Of Which 50 Added\",\"Sugar\"],\"has_english_ingredients\":true,\"minerals\":[],\"vitamins\":[],\"traces\":[],\"description\":null,\"keywords\":[\"Apple\",\"Applesauce\",\"Botany\",\"Netherland\",\"Sauce\",\"The\"]},{\"barcode\":\"9300601434800\",\"name\":\"Cream Apple Turnover\",\"brand\":\"Coles Patisserie,Coles\",\"ingredients\":\"Cream (min 23 %), Cream (23 %) (Cream, beef gelatine), thickener (E400), apple (min 23 %) (preservatives (E223, E202), wheat flour, eau, margarine (vegetable oils (canola, cottonseed, palm), water, salt, vegetable emulsifiers (E471, E322 (soy), food acid (E300), flavour, colour (E160a), sugar, thickeners (E1442, E1400, E461, E1422), regs (E330, E297), starch ((preservative (E223), raising agents (E920)), milk solids, colour (E160a).\",\"package\":{\"quantity\":1,\"size\":\"100g\"},\"serving\":{\"size\":null,\"measurement_unit\":null,\"size_fulltext\":null},\"categories\":[],\"nutrients\":[{\"name\":\"Nova Group\",\"per_100g\":4,\"measurement_unit\":null,\"rank\":null,\"data_points\":null,\"description\":null}],\"diet_labels\":{\"vegan\":{\"name\":\"Vegan\",\"is_compatible\":false,\"compatibility_level\":0,\"confidence\":true,\"confidence_description\":\"Not compatible with the Vegan diet.\"},\"vegetarian\":{\"name\":\"Vegetarian\",\"is_compatible\":false,\"compatibility_level\":0,\"confidence\":true,\"confidence_description\":\"Not compatible with the Vegetarian diet.\"},\"gluten_free\":{\"name\":\"Gluten Free\",\"is_compatible\":false,\"compatibility_level\":0,\"confidence\":true,\"confidence_description\":\"Not compatible with the Gluten Free diet.\"}},\"diet_flags\":[{\"ingredient\":\"Milk\",\"ingredient_description\":\"Not vegan if derived from an animal. Check the ingredients.\",\"diet_label\":\"Vegan\",\"is_compatible\":false,\"compatibility_level\":0,\"compatibility_description\":\"Banned - Not acceptable for diet\\/lifestyle.\",\"is_allergen\":true},{\"ingredient\":\"Gluten\",\"ingredient_description\":\"Gluten is a general name for the proteins found in different forms of wheat.\",\"diet_label\":\"Gluten Free\",\"is_compatible\":false,\"compatibility_level\":0,\"compatibility_description\":\"Banned - Not acceptable for diet\\/lifestyle.\",\"is_allergen\":true},{\"ingredient\":\"Beef\",\"ingredient_description\":\"Not vegan if originating from cow flesh.\",\"diet_label\":\"Vegan\",\"is_compatible\":false,\"compatibility_level\":0,\"compatibility_description\":\"Banned - Not acceptable for diet\\/lifestyle.\",\"is_allergen\":false},{\"ingredient\":\"E322\",\"ingredient_description\":\"Emulsifier - From soy or eggs. Check for vegan labeling or contact the supplier.\",\"diet_label\":\"Vegan\",\"is_compatible\":null,\"compatibility_level\":1,\"compatibility_description\":\"Not necessarily banned. Consider the source of each ingredient.\",\"is_allergen\":false},{\"ingredient\":\"E471\",\"ingredient_description\":\"Mono and di-glycerides of fatty acids (sometimes derived from animal fats).\",\"diet_label\":\"Vegan\",\"is_compatible\":null,\"compatibility_level\":1,\"compatibility_description\":\"Not necessarily banned. Consider the source of each ingredient.\",\"is_allergen\":false},{\"ingredient\":\"E920\",\"ingredient_description\":\"Improving Agent - Produced commercially from animal and human hair (and feathers).\",\"diet_label\":\"Vegan\",\"is_compatible\":null,\"compatibility_level\":1,\"compatibility_description\":\"Not necessarily banned. Consider the source of each ingredient.\",\"is_allergen\":false},{\"ingredient\":\"Sugar\",\"ingredient_description\":\"A sweet material that consists of sucrose. Some sugars are processed through boneblack.\",\"diet_label\":\"Vegan\",\"is_compatible\":null,\"compatibility_level\":1,\"compatibility_description\":\"Not necessarily banned. Consider the source of each ingredient.\",\"is_allergen\":false},{\"ingredient\":\"Beef\",\"ingredient_description\":\"Not a vegetarian friendly option. Beef is taken from the body of a cow.\",\"diet_label\":\"Vegetarian\",\"is_compatible\":false,\"compatibility_level\":0,\"compatibility_description\":\"Banned - Not acceptable for diet\\/lifestyle.\",\"is_allergen\":false},{\"ingredient\":\"E471\",\"ingredient_description\":\"Mono and di-glycerides of fatty acids (sometimes derived from animal fats).\",\"diet_label\":\"Vegetarian\",\"is_compatible\":null,\"compatibility_level\":1,\"compatibility_description\":\"Not necessarily banned. Consider the source of each ingredient.\",\"is_allergen\":false},{\"ingredient\":\"Wheat\",\"ingredient_description\":\"Wheat includes gluten. Check the ingredients if gluten-free is not on the label.\",\"diet_label\":\"Gluten Free\",\"is_compatible\":false,\"compatibility_level\":0,\"compatibility_description\":\"Banned - Not acceptable for diet\\/lifestyle.\",\"is_allergen\":false},{\"ingredient\":\"Starch\",\"ingredient_description\":\"If found on a meat or poultry product could be from any grain, including wheat.\",\"diet_label\":\"Gluten Free\",\"is_compatible\":null,\"compatibility_level\":1,\"compatibility_description\":\"Not necessarily banned. Consider the source of each ingredient.\",\"is_allergen\":false}],\"packaging_photos\":{\"front\":{\"small\":\"https:\\/\\/chompthis.com\\/api\\/assets\\/images\\/product\\/?i=930\\/060\\/143\\/4800\\/front_en.6.200.jpg\",\"thumb\":\"https:\\/\\/chompthis.com\\/api\\/assets\\/images\\/product\\/?i=930\\/060\\/143\\/4800\\/front_en.6.100.jpg\",\"display\":\"https:\\/\\/chompthis.com\\/api\\/assets\\/images\\/product\\/?i=930\\/060\\/143\\/4800\\/front_en.6.400.jpg\"},\"nutrition\":{\"small\":null,\"thumb\":null,\"display\":null},\"ingredients\":{\"small\":\"https:\\/\\/chompthis.com\\/api\\/assets\\/images\\/product\\/?i=930\\/060\\/143\\/4800\\/ingredients_en.7.200.jpg\",\"thumb\":\"https:\\/\\/chompthis.com\\/api\\/assets\\/images\\/product\\/?i=930\\/060\\/143\\/4800\\/ingredients_en.7.100.jpg\",\"display\":\"https:\\/\\/chompthis.com\\/api\\/assets\\/images\\/product\\/?i=930\\/060\\/143\\/4800\\/ingredients_en.7.400.jpg\"}},\"allergens\":[\"Gluten\",\"Milk\",\"Soybeans\"],\"brand_list\":[\"Coles\",\"Coles Patisserie\"],\"countries\":[\"Australia\"],\"country_details\":{\"english_speaking\":1,\"non_english_speaking\":0},\"palm_oil_ingredients\":[\"E160a Beta Carotene\",\"E471 Mono Et Diglycerides D Acides Gras Alimentaires\"],\"ingredient_list\":[\"23\",\"Apple\",\"Beef Gelatine\",\"Canola\",\"Colour\",\"Cottonseed\",\"Cream\",\"E1400\",\"E1422\",\"E1442\",\"E160a\",\"E202\",\"E223\",\"E297\",\"E300\",\"E322\",\"E330\",\"E400\",\"E461\",\"E471\",\"E920\",\"Eau\",\"Flavour\",\"Food Acid\",\"Margarine\",\"Milk Solids\",\"Min 23\",\"Palm\",\"Preservative\",\"Preservatives\",\"Raising Agents\",\"Regs\",\"Salt\",\"Soy\",\"Starch\",\"Sugar\",\"Thickener\",\"Thickeners\",\"Vegetable Emulsifiers\",\"Vegetable Oils\",\"Water\",\"Wheat Flour\"],\"has_english_ingredients\":true,\"minerals\":[],\"vitamins\":[],\"traces\":[\"Nuts\",\"Sesame Seeds\"],\"description\":null,\"keywords\":[\"Apple\",\"Australia\",\"Cole\",\"Cream\",\"Imported\",\"Patisserie\",\"Snack\",\"Sugary\",\"Turnover\",\"Unknown\",\"Viennoiserie\"]},{\"barcode\":\"9300608614229\",\"name\":\"Apple Juice \",\"brand\":\"The Daily Juice Company\",\"ingredients\":\"Reconstituted Apple Juice & Apple Juice (99.9%), Flavour, Preservative (202), Acidity Regulator (330), Vitamin C\",\"package\":{\"quantity\":2,\"size\":\"100g\"},\"serving\":{\"size\":\"200 ml\",\"measurement_unit\":null,\"size_fulltext\":null},\"categories\":[],\"nutrients\":[{\"name\":\"Energy\",\"per_100g\":157,\"measurement_unit\":\"kJ\",\"rank\":null,\"data_points\":null,\"description\":null},{\"name\":\"Fat\",\"per_100g\":1,\"measurement_unit\":\"g\",\"rank\":null,\"data_points\":null,\"description\":null},{\"name\":\"Carbohydrates\",\"per_100g\":10.4,\"measurement_unit\":\"g\",\"rank\":null,\"data_points\":null,\"description\":null},{\"name\":\"Sugars\",\"per_100g\":10.2,\"measurement_unit\":\"g\",\"rank\":null,\"data_points\":null,\"description\":null},{\"name\":\"Fiber\",\"per_100g\":1,\"measurement_unit\":\"g\",\"rank\":null,\"data_points\":null,\"description\":null},{\"name\":\"Proteins\",\"per_100g\":1,\"measurement_unit\":\"g\",\"rank\":null,\"data_points\":null,\"description\":null},{\"name\":\"Salt\",\"per_100g\":0.02032,\"measurement_unit\":\"g\",\"rank\":null,\"data_points\":null,\"description\":null},{\"name\":\"Sodium\",\"per_100g\":0.008,\"measurement_unit\":\"g\",\"rank\":null,\"data_points\":null,\"description\":null},{\"name\":\"Vitamin C\",\"per_100g\":20,\"measurement_unit\":\"mg\",\"rank\":null,\"data_points\":null,\"description\":null},{\"name\":\"Nova Group\",\"per_100g\":4,\"measurement_unit\":null,\"rank\":null,\"data_points\":null,\"description\":null}],\"diet_labels\":{\"vegan\":{\"name\":\"Vegan\",\"is_compatible\":null,\"compatibility_level\":1,\"confidence\":true,\"confidence_description\":\"Compatibility with the Vegan diet is unknown.\"},\"vegetarian\":{\"name\":\"Vegetarian\",\"is_compatible\":null,\"compatibility_level\":1,\"confidence\":true,\"confidence_description\":\"Compatibility with the Vegetarian diet is unknown.\"},\"gluten_free\":{\"name\":\"Gluten Free\",\"is_compatible\":true,\"compatibility_level\":2,\"confidence\":true,\"confidence_description\":\"Compatible with the Gluten Free diet.\"}},\"diet_flags\":[{\"ingredient\":\"Vitamin\",\"ingredient_description\":\"Likely animal based but may be plant based. Check the label to verify the source of the ingredient.\",\"diet_label\":\"Vegan\",\"is_compatible\":null,\"compatibility_level\":1,\"compatibility_description\":\"Not necessarily banned. Consider the source of each ingredient.\",\"is_allergen\":false},{\"ingredient\":\"Vitamin\",\"ingredient_description\":\"Likely animal based but may be plant based. Check the label to verify the source of the ingredient.\",\"diet_label\":\"Vegetarian\",\"is_compatible\":null,\"compatibility_level\":1,\"compatibility_description\":\"Not necessarily banned. Consider the source of each ingredient.\",\"is_allergen\":false}],\"packaging_photos\":{\"front\":{\"small\":\"https:\\/\\/chompthis.com\\/api\\/assets\\/images\\/product\\/?i=930\\/060\\/861\\/4229\\/front_en.3.200.jpg\",\"thumb\":\"https:\\/\\/chompthis.com\\/api\\/assets\\/images\\/product\\/?i=930\\/060\\/861\\/4229\\/front_en.3.100.jpg\",\"display\":\"https:\\/\\/chompthis.com\\/api\\/assets\\/images\\/product\\/?i=930\\/060\\/861\\/4229\\/front_en.3.400.jpg\"},\"nutrition\":{\"small\":null,\"thumb\":null,\"display\":null},\"ingredients\":{\"small\":null,\"thumb\":null,\"display\":null}},\"allergens\":[],\"brand_list\":[\"The Daily Juice Company\"],\"countries\":[\"Australia\"],\"country_details\":{\"english_speaking\":1,\"non_english_speaking\":0},\"palm_oil_ingredients\":[],\"ingredient_list\":[\"202\",\"330\",\"99 9\",\"Acidity Regulator\",\"Flavour\",\"Preservative\",\"Reconstituted Apple Juice Apple Juice\",\"Vitamin C\"],\"has_english_ingredients\":true,\"minerals\":[],\"vitamins\":[\"Vitamin C\"],\"traces\":[],\"description\":null,\"keywords\":[\"Added\",\"Apple\",\"Company\",\"Daily\",\"Juice\",\"Sugar\",\"The\"]},{\"barcode\":\"9300614000801\",\"name\":\"Apple blackcurrent fruit juice cordial\",\"brand\":\"Cottee's\",\"ingredients\":\"Sugar, water, Apple Juice 48%, Blackcurrant Juice 2%, Citric Acid, Natural Flavours, Fructose, Anthocyanins, Sodium Benzoate, Sodium Metabisulphite, Sodium Carboxymethlcellulose, Steviol Glycosides\",\"package\":{\"quantity\":1,\"size\":\"100g\"},\"serving\":{\"size\":\"250ml\",\"measurement_unit\":null,\"size_fulltext\":null},\"categories\":[],\"nutrients\":[{\"name\":\"Energy\",\"per_100g\":111,\"measurement_unit\":\"kJ\",\"rank\":null,\"data_points\":null,\"description\":null},{\"name\":\"Fat\",\"per_100g\":0,\"measurement_unit\":\"g\",\"rank\":null,\"data_points\":null,\"description\":null},{\"name\":\"Saturated Fat\",\"per_100g\":0,\"measurement_unit\":\"g\",\"rank\":null,\"data_points\":null,\"description\":null},{\"name\":\"Carbohydrates\",\"per_100g\":6.4,\"measurement_unit\":\"g\",\"rank\":null,\"data_points\":null,\"description\":null},{\"name\":\"Sugars\",\"per_100g\":6.4,\"measurement_unit\":\"g\",\"rank\":null,\"data_points\":null,\"description\":null},{\"name\":\"Proteins\",\"per_100g\":0,\"measurement_unit\":\"g\",\"rank\":null,\"data_points\":null,\"description\":null},{\"name\":\"Salt\",\"per_100g\":0.0254,\"measurement_unit\":\"g\",\"rank\":null,\"data_points\":null,\"description\":null},{\"name\":\"Sodium\",\"per_100g\":0.01,\"measurement_unit\":\"g\",\"rank\":null,\"data_points\":null,\"description\":null}],\"diet_labels\":{\"vegan\":{\"name\":\"Vegan\",\"is_compatible\":null,\"compatibility_level\":1,\"confidence\":true,\"confidence_description\":\"Compatibility with the Vegan diet is unknown.\"},\"vegetarian\":{\"name\":\"Vegetarian\",\"is_compatible\":null,\"compatibility_level\":1,\"confidence\":true,\"confidence_description\":\"Compatibility with the Vegetarian diet is unknown.\"},\"gluten_free\":{\"name\":\"Gluten Free\",\"is_compatible\":true,\"compatibility_level\":2,\"confidence\":true,\"confidence_description\":\"Compatible with the Gluten Free diet.\"}},\"diet_flags\":[{\"ingredient\":\"Citric\",\"ingredient_description\":\"Emulsifier - May contain animal fat as it is derived from Glycerin\\/Glycerol.\",\"diet_label\":\"Vegan\",\"is_compatible\":null,\"compatibility_level\":1,\"compatibility_description\":\"Not necessarily banned. Consider the source of each ingredient.\",\"is_allergen\":false},{\"ingredient\":\"Natural\",\"ingredient_description\":\"Ingredients are not synthetic or artificial, but extracted directly from plants or animal products\",\"diet_label\":\"Vegan\",\"is_compatible\":null,\"compatibility_level\":1,\"compatibility_description\":\"Not necessarily banned. Consider the source of each ingredient.\",\"is_allergen\":false},{\"ingredient\":\"Sugar\",\"ingredient_description\":\"A sweet material that consists of sucrose. Some sugars are processed through boneblack.\",\"diet_label\":\"Vegan\",\"is_compatible\":null,\"compatibility_level\":1,\"compatibility_description\":\"Not necessarily banned. Consider the source of each ingredient.\",\"is_allergen\":false},{\"ingredient\":\"Citric\",\"ingredient_description\":\"Emulsifier - May contain animal fat as it is derived from Glycerin\\/Glycerol.\",\"diet_label\":\"Vegetarian\",\"is_compatible\":null,\"compatibility_level\":1,\"compatibility_description\":\"Not necessarily banned. Consider the source of each ingredient.\",\"is_allergen\":false},{\"ingredient\":\"Natural\",\"ingredient_description\":\"Ingredients are not synthetic or artificial, but extracted directly from plants or animal products\",\"diet_label\":\"Vegetarian\",\"is_compatible\":null,\"compatibility_level\":1,\"compatibility_description\":\"Not necessarily banned. Consider the source of each ingredient.\",\"is_allergen\":false}],\"packaging_photos\":{\"front\":{\"small\":\"https:\\/\\/chompthis.com\\/api\\/assets\\/images\\/product\\/?i=930\\/061\\/400\\/0801\\/front_en.3.200.jpg\",\"thumb\":\"https:\\/\\/chompthis.com\\/api\\/assets\\/images\\/product\\/?i=930\\/061\\/400\\/0801\\/front_en.3.100.jpg\",\"display\":\"https:\\/\\/chompthis.com\\/api\\/assets\\/images\\/product\\/?i=930\\/061\\/400\\/0801\\/front_en.3.400.jpg\"},\"nutrition\":{\"small\":\"https:\\/\\/chompthis.com\\/api\\/assets\\/images\\/product\\/?i=930\\/061\\/400\\/0801\\/nutrition_en.7.200.jpg\",\"thumb\":\"https:\\/\\/chompthis.com\\/api\\/assets\\/images\\/product\\/?i=930\\/061\\/400\\/0801\\/nutrition_en.7.100.jpg\",\"display\":\"https:\\/\\/chompthis.com\\/api\\/assets\\/images\\/product\\/?i=930\\/061\\/400\\/0801\\/nutrition_en.7.400.jpg\"},\"ingredients\":{\"small\":\"https:\\/\\/chompthis.com\\/api\\/assets\\/images\\/product\\/?i=930\\/061\\/400\\/0801\\/ingredients_en.8.200.jpg\",\"thumb\":\"https:\\/\\/chompthis.com\\/api\\/assets\\/images\\/product\\/?i=930\\/061\\/400\\/0801\\/ingredients_en.8.100.jpg\",\"display\":\"https:\\/\\/chompthis.com\\/api\\/assets\\/images\\/product\\/?i=930\\/061\\/400\\/0801\\/ingredients_en.8.400.jpg\"}},\"allergens\":[],\"brand_list\":[\"Cottee's\"],\"countries\":[\"Australia\"],\"country_details\":{\"english_speaking\":1,\"non_english_speaking\":0},\"palm_oil_ingredients\":[],\"ingredient_list\":[\"Anthocyanins\",\"Apple Juice 48\",\"Blackcurrant Juice 2\",\"Citric Acid\",\"Fructose\",\"Natural Flavours\",\"Sodium Benzoate\",\"Sodium Carboxymethlcellulose\",\"Sodium Metabisulphite\",\"Steviol Glycosides\",\"Sugar\",\"Water\"],\"has_english_ingredients\":true,\"minerals\":[],\"vitamins\":[],\"traces\":[\"Sulphur Dioxide And Sulphites\"],\"description\":null,\"keywords\":[\"Apple\",\"Blackcurrent\",\"Cordial\",\"Cottee\",\"Fruit\",\"Juice\"]},{\"barcode\":\"9300633901349\",\"name\":\"Bakehouse Apple Pie\",\"brand\":\"Woolworths Bakehouse,Woolworths\",\"ingredients\":\"Apple (33%) (Contains preservative (233)), Wheat Flour, Sugar, Margarine (Animal Fat), Water, Salt, Emulsifiers (471,322, (From Soy), Antioxidant (320), Nature identical flavour), Water, Thickener, (1422, from maize), Baking, Powder (contains raising agents (450,500), Wheat Starch), Salt, Food Acid (330),Colour (160b), Preservative (200), Glaze (Milk Protein, Soya Lecithin) Cassia.\",\"package\":{\"quantity\":500,\"size\":\"100g\"},\"serving\":{\"size\":\"125g\",\"measurement_unit\":null,\"size_fulltext\":null},\"categories\":[],\"nutrients\":[{\"name\":\"Energy\",\"per_100g\":1100,\"measurement_unit\":\"kJ\",\"rank\":null,\"data_points\":null,\"description\":null},{\"name\":\"Fat\",\"per_100g\":10,\"measurement_unit\":\"g\",\"rank\":null,\"data_points\":null,\"description\":null},{\"name\":\"Saturated Fat\",\"per_100g\":5.1,\"measurement_unit\":\"g\",\"rank\":null,\"data_points\":null,\"description\":null},{\"name\":\"Trans Fat\",\"per_100g\":0.6,\"measurement_unit\":\"g\",\"rank\":null,\"data_points\":null,\"description\":null},{\"name\":\"Carbohydrates\",\"per_100g\":37,\"measurement_unit\":\"g\",\"rank\":null,\"data_points\":null,\"description\":null},{\"name\":\"Sugars\",\"per_100g\":21,\"measurement_unit\":\"g\",\"rank\":null,\"data_points\":null,\"description\":null},{\"name\":\"Fiber\",\"per_100g\":5.4,\"measurement_unit\":\"g\",\"rank\":null,\"data_points\":null,\"description\":null},{\"name\":\"Proteins\",\"per_100g\":3.5,\"measurement_unit\":\"g\",\"rank\":null,\"data_points\":null,\"description\":null},{\"name\":\"Salt\",\"per_100g\":863.59998,\"measurement_unit\":\"mg\",\"rank\":null,\"data_points\":null,\"description\":null},{\"name\":\"Sodium\",\"per_100g\":0.34,\"measurement_unit\":\"g\",\"rank\":null,\"data_points\":null,\"description\":null},{\"name\":\"Monounsaturated Fat\",\"per_100g\":4.4,\"measurement_unit\":\"g\",\"rank\":null,\"data_points\":null,\"description\":null},{\"name\":\"Nova Group\",\"per_100g\":4,\"measurement_unit\":null,\"rank\":null,\"data_points\":null,\"description\":null},{\"name\":\"Polyunsaturated Fat\",\"per_100g\":0.4,\"measurement_unit\":\"g\",\"rank\":null,\"data_points\":null,\"description\":null}],\"diet_labels\":{\"vegan\":{\"name\":\"Vegan\",\"is_compatible\":false,\"compatibility_level\":0,\"confidence\":true,\"confidence_description\":\"Not compatible with the Vegan diet.\"},\"vegetarian\":{\"name\":\"Vegetarian\",\"is_compatible\":false,\"compatibility_level\":0,\"confidence\":true,\"confidence_description\":\"Not compatible with the Vegetarian diet.\"},\"gluten_free\":{\"name\":\"Gluten Free\",\"is_compatible\":false,\"compatibility_level\":0,\"confidence\":true,\"confidence_description\":\"Not compatible with the Gluten Free diet.\"}},\"diet_flags\":[{\"ingredient\":\"Lecithin\",\"ingredient_description\":\"May contain egg yolks. Can also be directly obtained from animal fat or soy.\",\"diet_label\":\"Vegan\",\"is_compatible\":null,\"compatibility_level\":1,\"compatibility_description\":\"Not necessarily banned. Consider the source of each ingredient.\",\"is_allergen\":false},{\"ingredient\":\"Milk\",\"ingredient_description\":\"Not vegan if derived from an animal. Check the ingredients.\",\"diet_label\":\"Vegan\",\"is_compatible\":false,\"compatibility_level\":0,\"compatibility_description\":\"Banned - Not acceptable for diet\\/lifestyle.\",\"is_allergen\":false},{\"ingredient\":\"Animal\",\"ingredient_description\":\"This product contains an animal derivative. May not be vegan friendly.\",\"diet_label\":\"Vegan\",\"is_compatible\":false,\"compatibility_level\":0,\"compatibility_description\":\"Banned - Not acceptable for diet\\/lifestyle.\",\"is_allergen\":false},{\"ingredient\":\"Glaze\",\"ingredient_description\":\"A pure food glaze and natural glaze. Made with shellac from the lac bug. Also known as beetle juice.\",\"diet_label\":\"Vegan\",\"is_compatible\":null,\"compatibility_level\":1,\"compatibility_description\":\"Not necessarily banned. Consider the source of each ingredient.\",\"is_allergen\":false},{\"ingredient\":\"Sugar\",\"ingredient_description\":\"A sweet material that consists of sucrose. Some sugars are processed through boneblack.\",\"diet_label\":\"Vegan\",\"is_compatible\":null,\"compatibility_level\":1,\"compatibility_description\":\"Not necessarily banned. Consider the source of each ingredient.\",\"is_allergen\":false},{\"ingredient\":\"Animal\",\"ingredient_description\":\"This product contains an animal derivative. May not be vegetarian friendly.\",\"diet_label\":\"Vegetarian\",\"is_compatible\":false,\"compatibility_level\":0,\"compatibility_description\":\"Banned - Not acceptable for diet\\/lifestyle.\",\"is_allergen\":false},{\"ingredient\":\"Wheat\",\"ingredient_description\":\"Wheat includes gluten. Check the ingredients if gluten-free is not on the label.\",\"diet_label\":\"Gluten Free\",\"is_compatible\":false,\"compatibility_level\":0,\"compatibility_description\":\"Banned - Not acceptable for diet\\/lifestyle.\",\"is_allergen\":false},{\"ingredient\":\"Starch\",\"ingredient_description\":\"If found on a meat or poultry product could be from any grain, including wheat.\",\"diet_label\":\"Gluten Free\",\"is_compatible\":null,\"compatibility_level\":1,\"compatibility_description\":\"Not necessarily banned. Consider the source of each ingredient.\",\"is_allergen\":false}],\"packaging_photos\":{\"front\":{\"small\":\"https:\\/\\/chompthis.com\\/api\\/assets\\/images\\/product\\/?i=930\\/063\\/390\\/1349\\/front_en.3.200.jpg\",\"thumb\":\"https:\\/\\/chompthis.com\\/api\\/assets\\/images\\/product\\/?i=930\\/063\\/390\\/1349\\/front_en.3.100.jpg\",\"display\":\"https:\\/\\/chompthis.com\\/api\\/assets\\/images\\/product\\/?i=930\\/063\\/390\\/1349\\/front_en.3.400.jpg\"},\"nutrition\":{\"small\":\"https:\\/\\/chompthis.com\\/api\\/assets\\/images\\/product\\/?i=930\\/063\\/390\\/1349\\/nutrition_en.9.200.jpg\",\"thumb\":\"https:\\/\\/chompthis.com\\/api\\/assets\\/images\\/product\\/?i=930\\/063\\/390\\/1349\\/nutrition_en.9.100.jpg\",\"display\":\"https:\\/\\/chompthis.com\\/api\\/assets\\/images\\/product\\/?i=930\\/063\\/390\\/1349\\/nutrition_en.9.400.jpg\"},\"ingredients\":{\"small\":\"https:\\/\\/chompthis.com\\/api\\/assets\\/images\\/product\\/?i=930\\/063\\/390\\/1349\\/ingredients_en.7.200.jpg\",\"thumb\":\"https:\\/\\/chompthis.com\\/api\\/assets\\/images\\/product\\/?i=930\\/063\\/390\\/1349\\/ingredients_en.7.100.jpg\",\"display\":\"https:\\/\\/chompthis.com\\/api\\/assets\\/images\\/product\\/?i=930\\/063\\/390\\/1349\\/ingredients_en.7.400.jpg\"}},\"allergens\":[],\"brand_list\":[\"Woolworths\",\"Woolworths Bakehouse\"],\"countries\":[\"Australia\"],\"country_details\":{\"english_speaking\":1,\"non_english_speaking\":0},\"palm_oil_ingredients\":[],\"ingredient_list\":[\"1422\",\"160b\",\"200\",\"233\",\"320\",\"322\",\"33\",\"330\",\"450\",\"471\",\"500\",\"Animal Fat\",\"Antioxidant\",\"Apple\",\"Baking\",\"Colour\",\"Contains Preservative\",\"Contains Raising Agents\",\"Emulsifiers\",\"Food Acid\",\"From Maize\",\"From Soy\",\"Glaze\",\"Margarine\",\"Milk Protein\",\"Nature Identical Flavour\",\"Powder\",\"Preservative\",\"Salt\",\"Soya Lecithin Cassia\",\"Sugar\",\"Thickener\",\"Water\",\"Wheat Flour\",\"Wheat Starch\"],\"has_english_ingredients\":true,\"minerals\":[],\"vitamins\":[],\"traces\":[],\"description\":null,\"keywords\":[\"Apple\",\"Australia\",\"Bakehouse\",\"Pie\",\"Product\",\"Woolworth\"]},{\"barcode\":\"9300658403101\",\"name\":\"Le Rice - Apple Cinnamon\",\"brand\":\"Yoplait\",\"ingredients\":null,\"package\":{\"quantity\":2150,\"size\":\"100g\"},\"serving\":{\"size\":null,\"measurement_unit\":null,\"size_fulltext\":null},\"categories\":[],\"nutrients\":[],\"diet_labels\":{\"vegan\":{\"name\":\"Vegan\",\"is_compatible\":null,\"compatibility_level\":null,\"confidence\":null,\"confidence_description\":\"We aren't able to check for compatibility with Vegan diet as ingredients are missing.\"},\"vegetarian\":{\"name\":\"Vegetarian\",\"is_compatible\":null,\"compatibility_level\":null,\"confidence\":null,\"confidence_description\":\"We aren't able to check for compatibility with Vegetarian diet as ingredients are missing.\"},\"gluten_free\":{\"name\":\"Gluten Free\",\"is_compatible\":null,\"compatibility_level\":null,\"confidence\":null,\"confidence_description\":\"We aren't able to check for compatibility with Gluten Free diet as ingredients are missing.\"}},\"diet_flags\":[],\"packaging_photos\":{\"front\":{\"small\":\"https:\\/\\/chompthis.com\\/api\\/assets\\/images\\/product\\/?i=930\\/065\\/840\\/3101\\/front_en.6.200.jpg\",\"thumb\":\"https:\\/\\/chompthis.com\\/api\\/assets\\/images\\/product\\/?i=930\\/065\\/840\\/3101\\/front_en.6.100.jpg\",\"display\":\"https:\\/\\/chompthis.com\\/api\\/assets\\/images\\/product\\/?i=930\\/065\\/840\\/3101\\/front_en.6.400.jpg\"},\"nutrition\":{\"small\":\"https:\\/\\/chompthis.com\\/api\\/assets\\/images\\/product\\/?i=930\\/065\\/840\\/3101\\/nutrition_en.8.200.jpg\",\"thumb\":\"https:\\/\\/chompthis.com\\/api\\/assets\\/images\\/product\\/?i=930\\/065\\/840\\/3101\\/nutrition_en.8.100.jpg\",\"display\":\"https:\\/\\/chompthis.com\\/api\\/assets\\/images\\/product\\/?i=930\\/065\\/840\\/3101\\/nutrition_en.8.400.jpg\"},\"ingredients\":{\"small\":\"https:\\/\\/chompthis.com\\/api\\/assets\\/images\\/product\\/?i=930\\/065\\/840\\/3101\\/ingredients_en.7.200.jpg\",\"thumb\":\"https:\\/\\/chompthis.com\\/api\\/assets\\/images\\/product\\/?i=930\\/065\\/840\\/3101\\/ingredients_en.7.100.jpg\",\"display\":\"https:\\/\\/chompthis.com\\/api\\/assets\\/images\\/product\\/?i=930\\/065\\/840\\/3101\\/ingredients_en.7.400.jpg\"}},\"allergens\":[],\"brand_list\":[\"Yoplait\"],\"countries\":[\"Australia\"],\"country_details\":{\"english_speaking\":1,\"non_english_speaking\":0},\"palm_oil_ingredients\":[],\"ingredient_list\":[],\"has_english_ingredients\":true,\"minerals\":[],\"vitamins\":[],\"traces\":[],\"description\":null,\"keywords\":[\"Apple\",\"Cinnamon\",\"Rice\",\"Yoplait\"]},{\"barcode\":\"9300675042307\",\"name\":\"apple blackcurrant fruity drink\",\"brand\":\"goulburn valley\",\"ingredients\":null,\"package\":{\"quantity\":250,\"size\":\"100g\"},\"serving\":{\"size\":null,\"measurement_unit\":null,\"size_fulltext\":null},\"categories\":[],\"nutrients\":[],\"diet_labels\":{\"vegan\":{\"name\":\"Vegan\",\"is_compatible\":null,\"compatibility_level\":null,\"confidence\":null,\"confidence_description\":\"We aren't able to check for compatibility with Vegan diet as ingredients are missing.\"},\"vegetarian\":{\"name\":\"Vegetarian\",\"is_compatible\":null,\"compatibility_level\":null,\"confidence\":null,\"confidence_description\":\"We aren't able to check for compatibility with Vegetarian diet as ingredients are missing.\"},\"gluten_free\":{\"name\":\"Gluten Free\",\"is_compatible\":null,\"compatibility_level\":null,\"confidence\":null,\"confidence_description\":\"We aren't able to check for compatibility with Gluten Free diet as ingredients are missing.\"}},\"diet_flags\":[],\"packaging_photos\":{\"front\":{\"small\":\"https:\\/\\/chompthis.com\\/api\\/assets\\/images\\/product\\/?i=930\\/067\\/504\\/2307\\/front_en.3.200.jpg\",\"thumb\":\"https:\\/\\/chompthis.com\\/api\\/assets\\/images\\/product\\/?i=930\\/067\\/504\\/2307\\/front_en.3.100.jpg\",\"display\":\"https:\\/\\/chompthis.com\\/api\\/assets\\/images\\/product\\/?i=930\\/067\\/504\\/2307\\/front_en.3.400.jpg\"},\"nutrition\":{\"small\":null,\"thumb\":null,\"display\":null},\"ingredients\":{\"small\":null,\"thumb\":null,\"display\":null}},\"allergens\":[],\"brand_list\":[\"Goulburn Valley\"],\"countries\":[\"Australia\"],\"country_details\":{\"english_speaking\":1,\"non_english_speaking\":0},\"palm_oil_ingredients\":[],\"ingredient_list\":[],\"has_english_ingredients\":true,\"minerals\":[],\"vitamins\":[],\"traces\":[],\"description\":null,\"keywords\":[\"Apple\",\"Blackcurrant\",\"Drink\",\"Fruity\",\"Goulburn\",\"Valley\"]},{\"barcode\":\"9310113900137\",\"name\":\"Berri Australian Grown Apple Juice\",\"brand\":\"Berri\",\"ingredients\":null,\"package\":{\"quantity\":null,\"size\":\"100g\"},\"serving\":{\"size\":null,\"measurement_unit\":null,\"size_fulltext\":null},\"categories\":[],\"nutrients\":[],\"diet_labels\":{\"vegan\":{\"name\":\"Vegan\",\"is_compatible\":null,\"compatibility_level\":null,\"confidence\":null,\"confidence_description\":\"We aren't able to check for compatibility with Vegan diet as ingredients are missing.\"},\"vegetarian\":{\"name\":\"Vegetarian\",\"is_compatible\":null,\"compatibility_level\":null,\"confidence\":null,\"confidence_description\":\"We aren't able to check for compatibility with Vegetarian diet as ingredients are missing.\"},\"gluten_free\":{\"name\":\"Gluten Free\",\"is_compatible\":null,\"compatibility_level\":null,\"confidence\":null,\"confidence_description\":\"We aren't able to check for compatibility with Gluten Free diet as ingredients are missing.\"}},\"diet_flags\":[],\"packaging_photos\":{\"front\":{\"small\":\"https:\\/\\/chompthis.com\\/api\\/assets\\/images\\/product\\/?i=931\\/011\\/390\\/0137\\/front_en.5.200.jpg\",\"thumb\":\"https:\\/\\/chompthis.com\\/api\\/assets\\/images\\/product\\/?i=931\\/011\\/390\\/0137\\/front_en.5.100.jpg\",\"display\":\"https:\\/\\/chompthis.com\\/api\\/assets\\/images\\/product\\/?i=931\\/011\\/390\\/0137\\/front_en.5.400.jpg\"},\"nutrition\":{\"small\":null,\"thumb\":null,\"display\":null},\"ingredients\":{\"small\":null,\"thumb\":null,\"display\":null}},\"allergens\":[],\"brand_list\":[\"Berri\"],\"countries\":[\"Australia\"],\"country_details\":{\"english_speaking\":1,\"non_english_speaking\":0},\"palm_oil_ingredients\":[],\"ingredient_list\":[],\"has_english_ingredients\":true,\"minerals\":[],\"vitamins\":[],\"traces\":[],\"description\":null,\"keywords\":[\"Apple\",\"Australian\",\"Berri\",\"Grown\",\"Juice\"]},{\"barcode\":\"9310113900793\",\"name\":\"Apple, Pineapple & Guava Juice\",\"brand\":\"Berri\",\"ingredients\":null,\"package\":{\"quantity\":1,\"size\":\"100g\"},\"serving\":{\"size\":null,\"measurement_unit\":null,\"size_fulltext\":null},\"categories\":[],\"nutrients\":[],\"diet_labels\":{\"vegan\":{\"name\":\"Vegan\",\"is_compatible\":null,\"compatibility_level\":null,\"confidence\":null,\"confidence_description\":\"We aren't able to check for compatibility with Vegan diet as ingredients are missing.\"},\"vegetarian\":{\"name\":\"Vegetarian\",\"is_compatible\":null,\"compatibility_level\":null,\"confidence\":null,\"confidence_description\":\"We aren't able to check for compatibility with Vegetarian diet as ingredients are missing.\"},\"gluten_free\":{\"name\":\"Gluten Free\",\"is_compatible\":null,\"compatibility_level\":null,\"confidence\":null,\"confidence_description\":\"We aren't able to check for compatibility with Gluten Free diet as ingredients are missing.\"}},\"diet_flags\":[],\"packaging_photos\":{\"front\":{\"small\":\"https:\\/\\/chompthis.com\\/api\\/assets\\/images\\/product\\/?i=931\\/011\\/390\\/0793\\/front_en.6.200.jpg\",\"thumb\":\"https:\\/\\/chompthis.com\\/api\\/assets\\/images\\/product\\/?i=931\\/011\\/390\\/0793\\/front_en.6.100.jpg\",\"display\":\"https:\\/\\/chompthis.com\\/api\\/assets\\/images\\/product\\/?i=931\\/011\\/390\\/0793\\/front_en.6.400.jpg\"},\"nutrition\":{\"small\":\"https:\\/\\/chompthis.com\\/api\\/assets\\/images\\/product\\/?i=931\\/011\\/390\\/0793\\/nutrition_en.8.200.jpg\",\"thumb\":\"https:\\/\\/chompthis.com\\/api\\/assets\\/images\\/product\\/?i=931\\/011\\/390\\/0793\\/nutrition_en.8.100.jpg\",\"display\":\"https:\\/\\/chompthis.com\\/api\\/assets\\/images\\/product\\/?i=931\\/011\\/390\\/0793\\/nutrition_en.8.400.jpg\"},\"ingredients\":{\"small\":\"https:\\/\\/chompthis.com\\/api\\/assets\\/images\\/product\\/?i=931\\/011\\/390\\/0793\\/ingredients_en.7.200.jpg\",\"thumb\":\"https:\\/\\/chompthis.com\\/api\\/assets\\/images\\/product\\/?i=931\\/011\\/390\\/0793\\/ingredients_en.7.100.jpg\",\"display\":\"https:\\/\\/chompthis.com\\/api\\/assets\\/images\\/product\\/?i=931\\/011\\/390\\/0793\\/ingredients_en.7.400.jpg\"}},\"allergens\":[],\"brand_list\":[\"Berri\"],\"countries\":[\"Australia\"],\"country_details\":{\"english_speaking\":1,\"non_english_speaking\":0},\"palm_oil_ingredients\":[],\"ingredient_list\":[],\"has_english_ingredients\":true,\"minerals\":[],\"vitamins\":[],\"traces\":[],\"description\":null,\"keywords\":[\"100\",\"Apple\",\"Australia\",\"Australian\",\"Berri\",\"Fruit\",\"Grown\",\"Guava\",\"Juice\",\"Pineapple\"]}]}");
            JSONArray jsonArray = responseJson.getJSONArray("items");
            for (int i = 0; i < jsonArray.length(); i++) {
                try {
                    JSONObject jsonObject = jsonArray.getJSONObject(i);
                    Food food = new Food();
                    food.setName(jsonObject.getString("name"));

                    JSONObject packageGrams = jsonObject.getJSONObject("package");
                    int quantity = packageGrams.getInt("quantity");
                    float amount = quantity / 100.0f;

                    // get nutrients
                    JSONArray nutrients = jsonObject.getJSONArray("nutrients");
                    boolean energyFound = false;
                    boolean fatFound = false;
                    boolean carbohydratesFound = false;
                    boolean proteinsFound = false;
                    for (int j = 0; j < nutrients.length(); j++) {
                        JSONObject nutrient = nutrients.getJSONObject(j);
                        if (nutrient.getString("name").equals("Energy")) {
                            food.setCalories((int) (nutrient.getInt("per_100g") * amount));
                            energyFound = true;
                        }
                        if (nutrient.getString("name").equals("Fat")) {
                            food.setFat(nutrient.getInt("per_100g") * amount);
                            fatFound = true;
                        }
                        if (nutrient.getString("name").equals("Carbohydrates")) {
                            food.setCarbohydrates(nutrient.getInt("per_100g") * amount);
                            carbohydratesFound = true;
                        }
                        if (nutrient.getString("name").equals("Proteins")) {
                            food.setProtein(nutrient.getInt("per_100g") * amount);
                            proteinsFound = true;
                        }
                    }
                    if (energyFound && fatFound && carbohydratesFound && proteinsFound) {
                        System.out.println(food);
                        foods.add(food);
                    }
                } catch (JSONException jsone) {
                    // response did not contain the food or food entry was incomplete
                }
            }
            // } catch (IOException ioe) {
            // API unavailable
        } catch (JSONException jsone) {
            jsone.printStackTrace();
            // response was invalid json
        }

        // add any matching foods from internal database
        foods.addAll(foodDao.findFoodsByKeyword(keyword));

        // return combined list of foods
        return new ArrayList<>(foods);

    }

    public void deleteFood(Food food) {
        foodDao.deleteFoodByName(food.getName());
    }

    public void saveFood(Food food) {
        foodDao.saveFood(food);
    }
}
